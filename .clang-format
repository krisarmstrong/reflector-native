---
# Clang-Format Configuration for reflector-native
# High-performance C network code formatting standards

Language: Cpp
Standard: c++11

# Base style
BasedOnStyle: LLVM

# Indentation
IndentWidth: 4
TabWidth: 4
UseTab: ForIndentation
ContinuationIndentWidth: 4
IndentCaseLabels: false
IndentPPDirectives: None

# Column limits
ColumnLimit: 100
ReflowComments: true

# Alignment
AlignAfterOpenBracket: Align
AlignConsecutiveAssignments: false
AlignConsecutiveDeclarations: false
AlignEscapedNewlines: Right
AlignOperands: true
AlignTrailingComments: true

# Allow/disallow on same line
AllowShortBlocksOnASingleLine: false
AllowShortCaseLabelsOnASingleLine: false
AllowShortFunctionsOnASingleLine: None
AllowShortIfStatementsOnASingleLine: Never
AllowShortLoopsOnASingleLine: false

# Braces
BreakBeforeBraces: Linux
BraceWrapping:
  AfterFunction: true
  AfterControlStatement: false
  AfterStruct: true
  AfterEnum: true

# Pointer alignment
PointerAlignment: Right
DerivePointerAlignment: false

# Spacing
SpaceAfterCStyleCast: false
SpaceBeforeAssignmentOperators: true
SpaceBeforeParens: ControlStatements
SpaceInEmptyParentheses: false
SpacesInCStyleCastParentheses: false
SpacesInParentheses: false
SpacesInSquareBrackets: false

# Break rules
AlwaysBreakAfterReturnType: None
AlwaysBreakBeforeMultilineStrings: false
BreakBeforeBinaryOperators: None
BreakBeforeTernaryOperators: true

# Penalties (for line breaking decisions)
PenaltyBreakBeforeFirstCallParameter: 19
PenaltyBreakComment: 300
PenaltyBreakFirstLessLess: 120
PenaltyBreakString: 1000
PenaltyExcessCharacter: 1000000
PenaltyReturnTypeOnItsOwnLine: 60

# Include ordering
SortIncludes: true
IncludeBlocks: Regroup
IncludeCategories:
  - Regex:           '^"reflector\.h"'
    Priority:        1
  - Regex:           '^<linux/'
    Priority:        2
  - Regex:           '^<sys/'
    Priority:        3
  - Regex:           '^<[a-z_]+\.h>'
    Priority:        4
  - Regex:           '.*'
    Priority:        5

# Keep existing style in some cases
KeepEmptyLinesAtTheStartOfBlocks: false
MaxEmptyLinesToKeep: 1

# Bin packing
BinPackArguments: true
BinPackParameters: true
